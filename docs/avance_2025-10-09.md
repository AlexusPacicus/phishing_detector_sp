# ğŸ“… Avance â€“ 2025-10-09

## âœ… Trabajo realizado

### 1. Sistema de Scoring â€“ v1
- Implementado **sistema heurÃ­stico de scoring** para priorizar URLs orientadas a EspaÃ±a.
- Reglas basadas en:
  - **GeogrÃ¡fico**: `.es`, `.com.es`, `+34`, `â‚¬`.
  - **LingÃ¼Ã­stico**: tokens castellanos (`cliente`, `pago`, `multa`, etc.).
  - **Marcas nacionales**: `bbva`, `santander`, `caixabank`, `ing`, `correos`, etc.
  - **Hosting gratuito/local**: `webcindario`, `rf.gd`, etc.
  - **Fuzzy matching** con dominios `.es` de referencia.
  - **Penalizaciones**: TLDs LATAM, tokens en portuguÃ©s.
- **Umbrales de uso**:
  - `score_total â‰¥ 2` â†’ URL orientada a EspaÃ±a.
  - `score_total â‰¥ 7` â†’ candidata a dataset phishing en espaÃ±ol (alta confianza).
- Resultado: **236 URLs** procesadas â†’ **69 seleccionadas (inclusiÃ³n=1)** tras validaciÃ³n manual.

---

### 2. Features finales
- Consolidada funciÃ³n `extract_features(url)` en `scripts/features.py`.
- **10 features implementadas**, coherentes con `features.md`:
  - **Fuertes:** `protocol`, `tld_group`, `trusted_path_token`, `num_params`, `contains_equal`.
  - **Moderadas:** `domain_length`, `domain_entropy`, `suspicious_path_token`.
  - **EspecÃ­ficas:** `contains_percent`, `free_hosting`.
- Generado `features_inclusion1.csv` con las 69 URLs seleccionadas + features.

---

### 3. ValidaciÃ³n del modelo
- Modelo: **Logistic Regression** (`logreg_phishing_final.joblib`, con threshold propio).
- Dataset de prueba: **69 URLs (inclusiÃ³n=1)**.
- Resultados:
  - **TP (phishing detectado):** 60  
  - **FN (falsos negativos):** 9  
  - **Recall:** 0.87  
  - **Precision:** 1.0  
  - **F1-score:** 0.93  
  - **Accuracy:** 0.87  

Matriz de confusiÃ³n:
[[ 0 0]
[ 9 60]]

---

### 4. AnÃ¡lisis de fallos
URLs clasificadas errÃ³neamente como legÃ­timas:
- `area.clientes-ingdiirect.es-eu.org` â†’ tokens legitimadores (`clientes`, `login`).  
- `bancosantander.es.hotelparadis.es/...` â†’ exceso de confianza en `.es`.  
- `correosprepago.bnext.es/...` â†’ dominio fintech legÃ­timo, difÃ­cil de discriminar.  
- `draganov-8bb38d.ingress-erytho.easywp.com/...` â†’ free hosting no incluido en lista.  
- `ivresse.com/.../ionosv2/...` â†’ dominio base legÃ­timo, sin seÃ±ales fuertes.  
- `msantamobs.com/.../correos.es...` â†’ marca en path no detectada.  
- `wififpt.com.vn/.../bankia.es/...` â†’ TLD sospechoso, pero tokens legitimadores en ruta.  
- `servicio-ing.es/.../login` â†’ `.es` + token de confianza.

**Patrones comunes de error:**
- Confianza excesiva en `.es`.  
- Tokens â€œlegitimadoresâ€ en rutas.  
- Marcas ocultas en path.  
- Free hosting incompleto.  
- ConfusiÃ³n con dominios borderline.

---

### 5. PrÃ³ximos pasos
- ğŸ”§ Refinar `trusted_path_token` â†’ aplicar sÃ³lo en dominio principal, no en rutas.  
- ğŸ”§ Ampliar `suspicious_path_token` â†’ incluir `avisos`, `wp-admin`, `user`, `mail`, `acceso`.  
- ğŸ”§ Ampliar `free_hosting` â†’ aÃ±adir `easywp.com`, `000webhost.com`, etc.  
- ğŸ”§ Nueva feature: `brand_in_path` â†’ detectar marcas en rutas.  
- ğŸ”§ Validar scoring + modelo sobre un dataset mixto (phishing vs legÃ­timas).  

---

## ğŸ§­ ReflexiÃ³n del dÃ­a
- Se completÃ³ la **v1 del sistema de scoring** y se documentÃ³ su justificaciÃ³n.  
- Se consolidÃ³ la funciÃ³n `extract_features(url)` con las 10 features finales.  
- El modelo baseline Logistic Regression alcanza **alta precisiÃ³n (1.0)** pero con **recall limitado (0.87)**.  
- Los falsos negativos identificados dan una hoja de ruta clara para mejorar.  
- Proyecto cierra el dÃ­a con **pipeline end-to-end funcionando** y documentaciÃ³n coherente.

---
